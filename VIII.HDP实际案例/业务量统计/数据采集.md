### 数据采集

- flume配置文件

    ```
    a1.sources = r1
    a1.channels = c1
    a1.sources.r1.type = spooldir
    a1.sources.r1.spoolDir = /opt/data
    a1.sources.r1.batchSize = 1
    a1.sources.r1.channels = c1
    a1.channels = c1
    a1.channels.c1.type = memory
    a1.channels.c1.capacity = 10000
    a1.channels.c1.transactionCapacity = 10000
    a1.channels.c1.byteCapacityBufferPercentage = 20
    a1.channels.c1.byteCapacity = 800000
    a1.channels = c1
    a1.sinks = k1
    a1.sinks.k1.batchSize = 1
    a1.sinks.k1.type = hbase
    a1.sinks.k1.table = web_cmd_log
    a1.sinks.k1.columnFamily = cf_log
    a1.sinks.k1.serializer = org.apache.flume.sink.hbase.RegexHbaseEventSerializer
    a1.sinks.k1.serializer.rowKeyIndex = 0
    a1.sinks.k1.serializer.regex=(\\d+-\\d\\d-\\d\\d\\s\\d+:\\d+:\\d+)\\s.*cmd\\\":\\\"(\\d+)\\\".*\\\"phoneNum\\\":\\\"(\\d{0,13})\\\",\\\"username\\\":\\\"([a-z0-9_-]{3,16})\\\",\\\"name\\\":\\\"(.*)\\\",\\\"workOrgName\\\":\\\"(.*)\\\",\\\"workOrg\\\":\\\"(\\d+).*$
    a1.sinks.k1.serializer.colNames=ROW_KEY,cmd,phone,userName,name,workOrgName,workOrg
    
    a1.sinks.k1.channel = c1
    a1.sinks.k1.kerberosPrincipal = hbase/hdp40@BMSOFT.COM
    ```

注：正则表达式里，双引号需要使用\\\进行转义；-不能进行转义；该表达式可在java代码里进行测试